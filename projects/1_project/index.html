<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> LSTM and Siamese based PitchTrainer similarity calculation | Yuanlai He (Miles) </title> <meta name="author" content="Miles (Yuanlai) Ho"> <meta name="description" content="using Siamese network architecture and LSTM layers to process the input data"> <meta name="keywords" content="Software Development Engineer"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/command-line.png?0c818eda30e553ba2f0d187ca37db021"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://imilesho.github.io/projects/1_project/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?bf50d6d9dd867d3e0f3b0add94449649"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Yuanlai He (Miles) </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">Resume </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">LSTM and Siamese based PitchTrainer similarity calculation</h1> <p class="post-description">using Siamese network architecture and LSTM layers to process the input data</p> </header> <article> <h2 id="abstract">Abstract</h2> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/languageTrainer-480.webp 480w,/assets/img/languageTrainer-800.webp 800w,/assets/img/languageTrainer-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/languageTrainer.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Hardware" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The architecture of the Pitch Trainer project. </div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/siameseNetwork-480.webp 480w,/assets/img/siameseNetwork-800.webp 800w,/assets/img/siameseNetwork-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/siameseNetwork.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Hardware" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The architecture of the Siamese network. </div> <h2 id="introduction">Introduction</h2> <p>This project is a part of the PitchTrainer project. The goal of this project is to create a similarity calculation model for the PitchTrainer project. The model is based on the Siamese network architecture and uses LSTM layers to process the input data. Text similarity recognition is the key part of our project. We think that if the recognized text from Apple speech recognition API is semantic equivalent to the original text relatively, the audio can be also comprehended by a native speaker. So the problem to be addressed in this project is to use the Siamese architecture deep learning model which its two subnetworks are all LSTM layers to recognize the semantic similarities between the two texts.</p> <h2 id="dataset">Dataset</h2> <p>The dataset used in this project is Quora’s first public dataset regarding the problem of recognizing duplicate questions[1]. It is based on actual data from Quora helping us train and text semantic equivalence model. Our model is also focused on recognizing the similarities between the original text and the recognized text. For instance, “How can I be a good geologist?” and “What should I do to be a great geologist?” are the same questions. The total amount of samples in this dataset is over 400,000. Each sample has a duplicate question pair, ID, and a binary Integer of whether the question pair is duplicate.</p> <h2 id="flask-api-for-mobile-app-integration">Flask API for Mobile App Integration</h2> <pre><code class="language-app.py```">The app.py script establishes a Flask API server that provides endpoints for mobile applications to calculate the similarity between recognized and original texts. It utilizes the Siamese_Model.py to predict similarity scores and sentence_segmentation.py for aligning sentences before scoring.

### Usage
To start the server, run:

</code></pre> <p>python3 app.py</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The server listens on port 5001 and accepts POST requests to the /predict endpoint. The request body should include JSON with 'original_sentences' and 'recognized_sentences' keys. The server responds with a JSON containing the original, recognized sentences and their similarity scores.
### E.G.
request:
</code></pre></div></div> <p>curl –location ‘http://hostAddress:5001/predict’ <br> –header ‘Content-Type: application/json’ <br> –data ‘{ “original_sentences”: “The Great Wall of China, a marvel of engineering stretching over 13,000 miles, is a series of fortifications made of stone, brick, tamped earth, wood, and other materials. “, “recognized_sentences”: “The Great Wall of China, a movie of engineering striking over 13,000 miles, is a series of fortifications made of stone, break, tamped earth, wood, and other materials.” } ‘</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Response:
</code></pre></div></div> <p>[ { “original”: “The Great Wall of China, a marvel of engineering stretching over 13,000 miles, is a series of fortifications made of stone, brick, tamped earth, wood, and other materials.”, “recognized”: “The Great Wall of China, a movie of engineering striking over 13,000 miles, is a series of fortifications made of stone, break, tamped earth, wood, and other materials.”, “score”: 0.855381965637207 } ]</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Ensure to configure the logger as needed and check ./log/app.log for request and result logs.


## Training and Testing the model
To train the model, run the following command:
</code></pre></div></div> <p>python3 training.py</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>or just run the training.py file in your IDE.

## Testing the model on a single custom example
To test the model, run the following command:
</code></pre></div></div> <p>python3 main.py</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>or just run the main.py file in your IDE.

In this case, you can change the input data in the main.py file to your custom example.

## Siamese Architecture 
</code></pre></div></div> <p>Sub_SiameseNetwork_1( (embedding): Embedding(41708, 128) (lstm): LSTM(128, 128, batch_first=True) ) Sub_SiameseNetwork_2( (embedding): Embedding(41708, 128) (lstm): LSTM(128, 128, batch_first=True) )</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## Python Notebook Version
The python notebook version of this project is available at the following folder:
</code></pre></div></div> <p>./python_notebook_version/ ``` Note that the dataset path in the notebook is set to the default path. If you want to change the dataset path, you can change it in the notebook.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Miles (Yuanlai) Ho. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?4a129fbf39254905f505c7246e641eaf"></script> <script defer src="/assets/js/copy_code.js?7254ae07fe9cc5f3a10843e1c0817c9c" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{inlineMath:[["$","$"],["(",")"]],displayMath:[["$$","$$"],["[","]"]]},svg:{fontCache:"global"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>